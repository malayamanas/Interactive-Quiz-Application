{% load quiz_extras %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'homepage/css/style.css' %}">
</head>
<body class="body-wrap">
    <div class="container text-center">
        <h1>Quiz Results</h1>

        <div class="results-container mt-24">
            <p>
                {{ current_question.text }}
                <br>
                {% with user_answer=user_answers|get_item:current_question.id %}
                    <span>User Answer: </span>
                    {% if user_answer.selected_answer is None %}
                        <span>None</span>
                    {% else %}
                        <span>{{ user_answer.selected_answer }}</span>
                    {% endif %}
                    <br>
                    <span>Correct Answer: </span>
                    {% if current_question.is_true %}
                        <span>True</span>
                    {% else %}
                        <span>False</span>
                    {% endif %}
                    <br>
                    {% if user_answer.selected_answer is None %}
                        <span>üò∂</span>
                    {% elif user_answer.selected_answer == current_question.is_true %}
                        <span>üòÅ</span>
                    {% else %}
                        <span>üò≠</span>
                    {% endif %}
                {% endwith %}
            </p>

            <p class="mt-24">Your score: {{ score_percentage }}%</p>
        </div>

        <form method="post">
            {% csrf_token %}
            <div class="navigation-buttons mt-16">
                <!-- Show previous button if it's not the first result -->
                {% if not is_first_result %}
                    <button type="submit" name="previous" class="button button-secondary">Previous</button>
                {% endif %}

                <!-- Show next button if it's not the last result -->
                {% if not is_last_result %}
                    <button type="submit" name="next" class="button button-primary">Next</button>
                {% endif %}
            </div>
        </form>

        <footer class="mt-40">
            <div class="user-info">
                <p>Logged in as: {{ user.username }}</p>
                <a href="{% url 'quiz:logout' %}" class="button-sm">Logout</a>
                <a href="{% url 'quiz:user_home' %}" class="button button-primary">Back to User Home</a>
                <a href="{% url 'quiz:previous_results' %}" class="button button-primary">View Previous Quiz Results</a>
            </div>
        </footer>
    </div>
</body>
</html>
