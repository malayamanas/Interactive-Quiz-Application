{% load quiz_extras %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'homepage/css/style.css' %}">
</head>
<body class="body-wrap">
    <div class="container text-center">
        <h1>Quiz Results</h1>

        <div class="results-container mt-24">
            {% for question in questions %}
                <p>
                    {{ question.text }}
                    <br>
                    {% with user_answer=user_answers|get_item:question.id %}
                        <!-- Debugging Output -->
                        <span>User Answer: </span>
                        {% if user_answer.selected_answer is None %}
                            <span>None</span>
                        {% else %}
                            <span>{{ user_answer.selected_answer }}</span>
                        {% endif %}
                        <br>
                        <span>Correct Answer: </span>
                        {% if question.is_true %}
                            <span>True</span>
                        {% else %}
                            <span>False</span>
                        {% endif %}
                        <br>
                        {% if user_answer.selected_answer is None %}
                            <span>❓</span>
                        {% elif user_answer.selected_answer == question.is_true %}
                            <span>✔️</span>
                        {% else %}
                            <span>❌</span>
                        {% endif %}
                    {% endwith %}
                </p>
            {% endfor %}

            <p class="mt-24">Your score: {{ score_percentage }}%</p>
        </div>

        <footer class="mt-40">
            <div class="user-info">
                <p>Logged in as: {{ user.username }}</p>
                <a href="{% url 'quiz:logout' %}" class="button-sm">Logout</a>
                <a href="{% url 'quiz:user_home' %}" class="button button-primary">Back to User Home</a>
                <a href="{% url 'quiz:previous_results' %}" class="button button-primary">View Previous Quiz Results</a>
            </div>
        </footer>
    </div>
</body>
</html>
