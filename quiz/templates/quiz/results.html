{% load quiz_extras %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>

</head>
<body>
    <h1>Quiz Results</h1>

    <div class="results-container">
        {% for question in questions %}
            <p>
                {{ question.text }}
                {% with user_answer=user_answers|get_item:question.id %}
                    <!-- Debugging Output -->
                    <br>User Answer: 
                    {% if user_answer.selected_answer is None %}
                        None
                    {% else %}
                        {{ user_answer.selected_answer }}
                    {% endif %}
                    <br>Correct Answer: {% if question.is_true %}True{% else %}False{% endif %}
                    
                    {% if user_answer.selected_answer is None %}
                        ❓
                    {% elif user_answer.selected_answer == question.is_true %}
                        ✔️
                    {% else %}
                        ❌
                    {% endif %}
                {% endwith %}
            </p>
        {% endfor %}

        <p>Your score: {{ score_percentage }}%</p>
    </div>

    <footer>
        <div class="user-info">
            <p>Logged in as: {{ user.username }}</p>
            <a href="{% url 'quiz:logout' %}">Logout</a>
        </div>
    </footer>
</body>
</html>
